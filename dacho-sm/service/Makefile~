CFLAGS = -I/home/mawandm/usr/src/openjdk/jdk/src/share/javavm/export -I/usr/lib/jvm/java-6-openjdk-amd64/include/ -I/home/mawandm/usr/src/openjdk/jdk/src/solaris/javavm/export/

#LDFLAGS = -L../../../../../external/gsl-1.1/.libs/ \
#	-L../../../../../external/gsl-1.1/cblas/.libs/ -lgsl -lgslcblas \
#	-lboost_date_time

build_dir=./build
objects = \
$(build_dir)/dachojvm.o \
$(build_dir)/service.o \
$(build_dir)/daemon.o \
$(build_dir)/main.o

output = $(build_dir)/dacho

CC=g++ -Wextra -Wall -g

all: build_dir_rule dachojvm.o service.o daemon.o main.o
	$(CC) $(LDFLAGS) -o $(output) $(objects)

dachojvm.o: src/dachojvm.h
	$(CC) -c $(CFLAGS) -o $(build_dir)/dachojvm.o src/dachojvm.cpp
service.o: src/service.h
	$(CC) -c $(CFLAGS) -o $(build_dir)/service.o src/service.cpp
daemon.o: src/daemon.h
	$(CC) -c $(CFLAGS) -o $(build_dir)/daemon.o src/daemon.cpp
main.o:
	$(CC) -c $(CFLAGS) -o $(build_dir)/main.o src/main.cpp

build_dir_rule:
	if [ ! -d $(build_dir) ] ; then \
		mkdir $(build_dir) ; \
	fi

.PHONY: clean
clean:
	rm $(objects) $(output)